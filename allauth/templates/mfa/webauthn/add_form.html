{% extends "mfa/webauthn/base.html" %}
{% load i18n static %}
{% block content %}
    <h1>{% trans "Add Security Key or Device" %}</h1>
    {{ totp_svg|safe }}
    <form method="POST" action="{% url 'mfa_add_webauthn' %}">
        {% csrf_token %}
        {{ form.as_p }}
        <button id="mfa_webauthn_add" type="button">{% trans "Add key or device" %}</button>
    </form>
    <noscript>{% translate "This functionality requires JavaScript." %}"</noscript>
    <script type="text/javascript" src="{% static 'mfa/js/webauthn.js' %}"></script>
    {{ js_data|json_script:"js_data" }}
    <script>
        allauth.webauthn.forms.addForm({
            ids: {
                add: "mfa_webauthn_add",
                passwordless: "{{ form.passwordless.auto_id }}",
                credential: "{{ form.credential.auto_id }}"
            },
            data: JSON.parse(document.getElementById('js_data').textContent)
        })
    </script>
{% endblock %}
